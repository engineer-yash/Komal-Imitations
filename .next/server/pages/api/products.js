"use strict";(()=>{var e={};e.id=221,e.ids=[221],e.modules={9344:e=>{e.exports=require("jsonwebtoken")},1185:e=>{e.exports=require("mongoose")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,r){return r in t?t[r]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,r)):"function"==typeof t&&"default"===r?t:void 0}}})},4710:(e,t,r)=>{r.r(t),r.d(t,{config:()=>m,default:()=>p,routeModule:()=>f});var n={};r.r(n),r.d(n,{default:()=>c});var a=r(1802),o=r(7153),s=r(6249),i=r(2549),u=r(8350),d=r(6044);async function l(e,t){if(await (0,i.Z)(),"GET"===e.method)try{let{category:r,gender:n,minPrice:a,maxPrice:o,featured:s}=e.query,i={};r&&(i.categoryId=r),n&&(i.gender=n),(a||o)&&(i.price={},a&&(i.price.$gte=parseFloat(a)),o&&(i.price.$lte=parseFloat(o))),s&&(i.featured="true"===s);let d=await u.Z.find(i).populate("categoryId").sort({createdAt:-1});return t.status(200).json(d)}catch(e){return t.status(500).json({message:e.message})}if("POST"===e.method)try{let r=await u.Z.create(e.body);return t.status(201).json(r)}catch(e){return t.status(500).json({message:e.message})}if("PUT"===e.method)try{let{id:r,...n}=e.body,a=await u.Z.findByIdAndUpdate(r,n,{new:!0});return t.status(200).json(a)}catch(e){return t.status(500).json({message:e.message})}if("DELETE"===e.method)try{let{id:r}=e.query;return await u.Z.findByIdAndDelete(r),t.status(200).json({message:"Product deleted"})}catch(e){return t.status(500).json({message:e.message})}return t.status(405).json({message:"Method not allowed"})}function c(e,t){return"GET"===e.method?l(e,t):(0,d.l)(l)(e,t)}let p=(0,s.l)(n,"default"),m=(0,s.l)(n,"config"),f=new a.PagesAPIRouteModule({definition:{kind:o.x.PAGES_API,page:"/api/products",pathname:"/api/products",bundlePath:"",filename:""},userland:n})},6044:(e,t,r)=>{r.d(t,{l:()=>s});var n=r(9344),a=r.n(n);let o=e=>{try{return a().verify(e,process.env.JWT_SECRET)}catch(e){return null}},s=e=>async(t,r)=>{let n=t.headers.authorization?.split(" ")[1];if(!n)return r.status(401).json({message:"No token provided"});let a=o(n);return a?(t.user=a,e(t,r)):r.status(401).json({message:"Invalid token"})}},2549:(e,t,r)=>{r.d(t,{Z:()=>i});var n=r(1185),a=r.n(n);let o=process.env.MONGODB_URI;if(!o)throw Error("Please define the MONGODB_URI environment variable");let s=global.mongoose;s||(s=global.mongoose={conn:null,promise:null});let i=async function(){if(s.conn)return s.conn;s.promise||(s.promise=a().connect(o,{bufferCommands:!1}).then(e=>e));try{s.conn=await s.promise}catch(e){throw s.promise=null,e}return s.conn}},8350:(e,t,r)=>{r.d(t,{Z:()=>s});var n=r(1185),a=r.n(n);let o=new(a()).Schema({name:{type:String,required:!0},categoryId:{type:a().Schema.Types.ObjectId,ref:"Category",required:!0},imageUrl:{type:String,required:!0},cloudinaryPublicId:{type:String},price:{type:Number,required:!0},size:String,gender:{type:String,enum:["Male","Female","Unisex"],default:"Unisex"},description:String,featured:{type:Boolean,default:!1},aiGenerated:{type:Boolean,default:!1},features:{type:[String],default:[]}},{timestamps:!0}),s=a().models.Product||a().model("Product",o)},7153:(e,t)=>{var r;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return r}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(r||(r={}))},1802:(e,t,r)=>{e.exports=r(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var r=t(t.s=4710);module.exports=r})();